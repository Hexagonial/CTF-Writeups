# format string 2
Challenge Description:
> This program is not impressed by cheap parlor tricks like reading arbitrary data off the stack. To impress this program you must change data on the stack!

CTF: <b>picoCTF</b> (picoGym)<br>Difficulty: <b>Medium</b>

<b>[Jump to solution](#solution)</b>

## Hints
Here are the hints provided by the challenge author.
<details>
<summary>Hint 1</summary>

> pwntools are very useful for this problem!
</details>

## Procedure
The program seems to want us to overwrite a certain variable with a certain value.
```
$ ./vuln
You don't have what it takes. Only a true wizard could change my suspicions. What do you have to say?
hammy
Here's your input: hammy
sus = 0x21737573
You can do better!
$ 
```
When disassembling `main` in gdb, we can see some key information:
```
   0x0000000000401273 <+125>:	mov    eax,DWORD PTR [rip+0x2de7] 
   # 0x404060 <sus>
   0x0000000000401279 <+131>:	cmp    eax,0x67616c66
```

1. The address of the `sus` variable is `0x404060`, which is a code address and thus probably not overflowable by input on the stack.
2. The `sus` variable seems to be compared to `0x67616c66`, which is likely what we want to overwrite `sus` with.

That's about all the information from the program we need - all we have left is to find the offset of our input in the format string, which can be done using pwntools' `FmtStr`. From there, `fmtstr_payload` handles the rest.

```
$ python3 format-string-2.py
hammy{u win - hammy}
```

## Solution
1. Find the address of `sus` in gdb, and the value `sus` needs to be set to by our payload in either gdb or the source code.
2. Find the offset of our input in the format string by testing or using pwntools' FmtStr automation.
3. Craft the payload using pwntools fmtstr_payload and send it.
